/***************************************************************************************************************************************************************************************/
/************************************************* SWE     : KPD DRIVER              *************************************************************************************************************/
/************************************************* BY      : Youssef Ayman           *************************************************************************************************************/
/************************************************* Date    : 27Aug20                 *************************************************************************************************************/
/************************************************* Version : v1.0                    *************************************************************************************************************/
/***************************************************************************************************************************************************************************************/
# include "STD_TYPES.h"
# include "BIT_MATH.h"
# include "DIO_interface.h"
# include "DIO_private.h"
# include "KPD_config.h"
# include <util/delay.h>



u8 KPD_u8GetPressedKey (void)
{
	BUTTONS
	u8 Local_u8PressedKey,x;

	u8 Column_Arr[]={Pin3,Pin2,Pin1,Pin0};
	u8 Row_Arr[]   ={Pin4,Pin5,Pin6,Pin7};

	for (u8 col=0;col<4;col++)
	{
		DIO_VidSetPinValue(KPD_PORT,Column_Arr[col],PinLow);

		for (u8 row=0;row<4;row++)
		{
			DIO_VidGetPinValue(KPD_PORT,Row_Arr[row],&x);

			if (x==0)
			{
				Local_u8PressedKey=KPD_Arr[row][col];

				while (x==0)
				{
					DIO_VidGetPinValue(KPD_PORT,Row_Arr[row],&x);

				}

				//_delay_ms(250);

				return Local_u8PressedKey;

			}


		}

		DIO_VidSetPinValue(KPD_PORT,Column_Arr[col],PinHigh);

	}

	return 101;

	
}




